# Methods

## Data Description

```{r}
#| message = FALSE,
#| warning = FALSE,
#| echo = FALSE
countCountries <- dataFinished[,3:3] %>% group_by(country)
countCountries <- countCountries[!duplicated(countCountries),] 
countCountries <- countCountries[order(countCountries$country),]
```

The provided data consists of $`r nrow(dataFinished)`$ different datasets from $`r nrow(countCountries)`$ different states. The data was set up into City, State, Country, Cost of Living Plus Rent Index, CLI, Rent Index, Groceries Index, Restaurant Index, Local Purchasing Power Index, Leverage Model 1 and Leverage Model 2 attributes.

In Figure \@ref(fig:continentCountdata) can be seen how many data sets are available per region.

```{r}
#| echo = FALSE,
#| warning = FALSE,
#| label = "continentCountdata",
#| fig.cap = "Count of Data from different regions",
#| out.width = "80%",
#| fig.asp = 0.75,
#| fig.align = "center",
#| fig.pos = "H",

ggplot(data = dataFinished, aes(x = region)) +
  geom_bar() +
  ggtitle("Region - Count data") +
  xlab("Regions") +
  ylab("Number of Data") +
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))
```

In addition to the overview of datasets by region in figure \@ref(fig:continentCountdata), a world map in figure \@ref(fig:worldMap) has been created to illustrate the countries from which the data sets originate. The data sets from the industrialized countries were marked in blue and those from the emerging and developing countries in red.

```{r}
#| echo = FALSE,
#| warning = FALSE,
#| label = "worldMap",
#| fig.cap = "Industrialized and developing countries",
#| out.width = "80%",
#| fig.asp = 0.75,
#| fig.align = "center",
#| fig.pos = "H",


MapData <- dataFinished
#selecting attributes (country, development)
MapData <- MapData %>% select(3,13)
colnames(MapData)[1] <- "region"
MapData <- distinct(MapData)
#merge data
world <- map_data("world")
MapData$region[MapData$region == "United States"] <- "USA"
MapData$region[MapData$region == "United Kingdom"] <- "UK"
MapData <- left_join(MapData, world, by="region")

plain <- theme(
  axis.text = element_blank(),
  axis.line = element_blank(),
  axis.ticks = element_blank(),
  panel.border = element_blank(),
  panel.grid = element_blank(),
  panel.background = element_rect(fill = "white"),
  plot.title = element_text(hjust = 0.5)
)
worldDD <- ggplot(data = MapData, mapping = aes(x = long, y = lat, group = group)) +
  borders("world", fill="grey90",colour="grey") + 
  coord_fixed(1.3) +
  geom_polygon(aes(fill = development)) +
  scale_fill_distiller(palette ="RdBu", direction = 1) +
  guides(fill = "none") +
  plain +
  labs(title = "", x = "Red = Developing Countries, Blue = Industrialized Countries", y = "")

worldDD

```

## Exploratory Data Analysis

First of all, we had to check, if there are missing values inside of the data set. Therefore we used the following code to proof this:


```{r}
#| echo = TRUE,
#| message = TRUE
summary(is.na(dataFinished))
```


As it can be seen, there were $`r sum(is.na(dataFinished$state))`$ missing values inside the column "state". 
However, since the column has no bearing on our research question, we decided to disregard this column. With the city column we have a more meaningful basis to answer our question.
To disregard this column, we cut it off. To do this, we used to following R code chunk. Because it is the second column, we can just delete this column.


```{r}
dataFinished <- dataFinished[-2]
```


We also truncated the leverage_model_1 and leverage_model_2 columns, since we did not work with these columns any further.


```{r}
dataFinished <- dataFinished[-9]
dataFinished <- dataFinished[-9]
```


To determine if outliers exist within the data set, we chose to draw a boxplot.


```{r}
#| echo = FALSE,
#| warning = FALSE,
#| label = "boxplot",
#| fig.cap = "Boxplot of Data to identify outliers",
#| out.width = "80%",
#| fig.asp = 0.75,
#| fig.align = "center",
#| fig.pos = "H",

dataBoxplot <- dataFinished %>%
  mutate(across(where(is.factor), as.numeric))
  
col = c('cost_of_living_plus_rent_index','cli','rent_index','groceries_index','restaurant_price_index','local_purchasing_power_index')
boxplot(dataBoxplot[,c('cost_of_living_plus_rent_index','cli','rent_index','groceries_index','restaurant_price_index','local_purchasing_power_index')])
```

As can be seen from the figure \@ref(fig:boxplot), there are several outliers within the data set. In order not to distort the result, we decided to keep these outliers and to continue working with them.

\clearpage
